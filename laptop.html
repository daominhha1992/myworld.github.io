<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>üõçÔ∏è C·ª≠a h√†ng</title>
  <style>
    body { font-family: 'Inter', sans-serif; max-width: 900px; margin: 30px auto; padding: 10px; }
    h1 { text-align: center; }
    .controls { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
    input, select { padding: 6px; flex: 1; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
    .item { border: 1px solid #ddd; border-radius: 8px; padding: 10px; text-align: center; }
    .thumb { width: 100%; height: 150px; object-fit: cover; border-radius: 6px; }
    .price { color: #d00; font-weight: bold; }
  </style>
</head>
<body>
  <h1>üõí Danh s√°ch s·∫£n ph·∫©m</h1>

  <div class="controls">
    <input id="search" placeholder="T√¨m theo t√™n ho·∫∑c CPU...">
    <select id="sort">
      <option value="">S·∫Øp x·∫øp</option>
      <option value="asc">Gi√° tƒÉng d·∫ßn</option>
      <option value="desc">Gi√° gi·∫£m d·∫ßn</option>
    </select>
  </div>

  <div id="grid" class="grid"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCc61PL3pcx8Bu1dILd_fm7vgA4cnWiCIc",
      authDomain: "hahaohan-9486c.firebaseapp.com",
      projectId: "hahaohan-9486c",
      storageBucket: "hahaohan-9486c.firebasestorage.app",
      messagingSenderId: "820514218791",
      appId: "1:820514218791:web:de9cb93ab77fd35db73f02",
      measurementId: "G-2F8FJYKSN1"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const grid = document.getElementById("grid");
    const searchEl = document.getElementById("search");
    const sortEl = document.getElementById("sort");

    let products = [];

    async function loadProducts() {
      grid.innerHTML = "ƒêang t·∫£i d·ªØ li·ªáu...";
      const snapshot = await getDocs(collection(db, "products"));
      products = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
      render();
    }

    function render() {
      let res = [...products];
      const q = searchEl.value.trim().toLowerCase();

      if (q)
        res = res.filter(p =>
          p.name.toLowerCase().includes(q) ||
          p.cpu.toLowerCase().includes(q)
        );

      if (sortEl.value === "asc") res.sort((a, b) => a.price - b.price);
      if (sortEl.value === "desc") res.sort((a, b) => b.price - a.price);

      if (!res.length) {
        grid.innerHTML = "<p>Kh√¥ng c√≥ s·∫£n ph·∫©m ph√π h·ª£p.</p>";
        return;
      }

      grid.innerHTML = res.map(p => `
        <div class="item">
          <img class="thumb" src="${p.img}" alt="${p.name}" onerror="this.src='noimage.jpg'">
          <h3>${p.name}</h3>
          <p>${p.brand}</p>
          <p>${p.cpu} / ${p.ram.replace(/GB/i, '')}GB / ${p.ssd.replace(/GB/i, '')}GB SSD / ${p.screen}</p>
          <p class="price">${p.price.toLocaleString()} VNƒê</p>
        </div>
      `).join("");
    }

    searchEl.oninput = render;
    sortEl.onchange = render;

    loadProducts();
  </script>
</body>
</html>
